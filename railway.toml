# Railway Configuration
# Documentação: https://docs.railway.com/deploy/config-as-code

[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile.railway"

# Variáveis disponíveis durante o build
[build.args]
VITE_API_URL = "/api"
NODE_ENV = "production"

[deploy]
# Número de réplicas (1 para Hobby plan)
replicas = 1

# Healthcheck endpoint
healthcheckPath = "/api/health"
healthcheckTimeout = 60
startCommand = "sh -c 'sleep 5 && gunicorn -w 1 -b 0.0.0.0:$PORT --timeout 120 --keep-alive 2 --max-requests 1000 app:app'"

# Porta exposta (deve bater com o EXPOSE do Dockerfile)
port = 8080

# Política de restart
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
